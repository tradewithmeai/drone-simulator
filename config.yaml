# Drone Swarm Simulation Configuration

# GUI Settings
use_gui: true
gui:
  window_width: 800
  window_height: 600
  background_color: [0.1, 0.1, 0.2]
  auto_spawn_on_start: true    # Auto-spawn drones at startup
  up_axis: "y"                 # Coordinate system: "y" (Y-up) or "z" (Z-up)
  
  # Display toggles
  enable_overlay: true         # Master switch for all overlays (disable for stability)
  show_fps: true
  show_sim_time: true
  show_formation_type: true
  show_labels: false  # Drone ID labels
  show_formation_lines: true  # Formation connection lines
  show_help: false  # Help overlay
  
  # Camera settings
  smooth_camera: false  # Temporarily disabled to debug
  camera_smoothing: 0.1  # Interpolation factor (0-1)
  
  # HUD settings
  hud_font_size: 16
  hud_color: [0.0, 0.5, 1.0]  # Blue text
  
# Drone Settings (unified)
drones:
  count: 9                     # Number of drones to spawn
  spawn_preset: v              # Initial spawn formation: v | line | circle | grid | random
  spawn_altitude: 10.0         # Altitude for spawning (meters) 
  spacing: 5.0                 # Inter-drone spacing (meters)
  seed: 42                     # Random seed for deterministic placement
  
  # Drone appearance  
  size: 0.5                    # Drone size in meters
  colors:
    - [1.0, 0.0, 0.0]  # Red
    - [0.0, 1.0, 0.0]  # Green
    - [0.0, 0.0, 1.0]  # Blue
    - [1.0, 1.0, 0.0]  # Yellow
    - [1.0, 0.0, 1.0]  # Magenta
    - [0.0, 1.0, 1.0]  # Cyan
    - [1.0, 0.5, 0.0]  # Orange
    - [0.5, 0.0, 1.0]  # Purple

# Simulation Settings
simulation:
  update_rate: 60              # Hz

# Physics Settings (QuadrotorPhysics)
physics:
  mass: 1.5                    # kg
  arm_length: 0.25             # meters (motor to center)
  gravity: 9.81                # m/s^2
  drag_coeff: 0.1              # linear drag coefficient
  angular_drag: 0.05           # angular drag coefficient
  motor_thrust_coeff: 1.9e-7   # thrust = k * rpm^2 (N)
  motor_torque_coeff: 5.0e-9   # reaction torque = k * rpm^2 (N*m)
  max_rpm: 8000.0
  min_rpm: 0.0
  motor_time_constant: 0.02    # motor response time (seconds)
  inertia_xx: 0.02             # kg*m^2 (pitch)
  inertia_yy: 0.04             # kg*m^2 (yaw)
  inertia_zz: 0.02             # kg*m^2 (roll)

# Flight Controller Settings (cascaded PID)
flight_controller:
  # Position → Velocity (outer loop)
  pos_kp: 0.8
  pos_ki: 0.0
  pos_kd: 0.2
  max_velocity: 8.0            # m/s

  # Velocity → Tilt angle
  vel_kp: 1.2
  vel_ki: 0.05
  vel_kd: 0.02
  max_tilt_angle: 0.35         # radians (~20 degrees)

  # Altitude PID
  alt_kp: 1.0
  alt_ki: 0.1
  alt_kd: 0.6
  max_vertical_vel: 5.0        # m/s
  max_thrust_adjust: 0.25

  # Attitude → Angular rate
  att_kp: 5.0
  att_ki: 0.0
  att_kd: 0.2
  max_rate: 4.0                # rad/s

  # Angular rate → Motor torques
  rate_kp: 0.3
  rate_ki: 0.02
  rate_kd: 0.0

# Sensor Noise Settings
sensors:
  perfect_mode: false            # Set true to disable all sensor noise

  imu:
    accel_noise_std: 0.02        # m/s^2 white noise
    accel_bias_drift: 0.0001     # m/s^2 per tick random walk
    accel_bias_max: 0.2          # m/s^2 max accumulated bias
    gyro_noise_std: 0.001        # rad/s white noise
    gyro_bias_drift: 0.00005     # rad/s per tick random walk
    gyro_bias_max: 0.01          # rad/s max accumulated bias

  gps:
    update_rate: 10.0            # Hz (consumer GPS is 5-10 Hz)
    pos_noise_h: 1.5             # meters horizontal std dev
    pos_noise_v: 3.0             # meters vertical std dev
    vel_noise_std: 0.1           # m/s velocity std dev

  baro:
    noise_std: 0.3               # meters white noise
    bias_drift: 0.001            # meters per tick random walk
    bias_max: 2.0                # meters max accumulated bias

  rangefinder:
    noise_std: 0.02              # meters
    max_range: 40.0              # meters (returns -1 beyond this)

  battery:
    voltage_noise_std: 0.01      # volts
    current_noise_std: 0.05      # amps

# Wind / Environment
wind:
  enabled: false
  base_velocity: [0.0, 0.0, 0.0]  # constant wind [vx, vy, vz] m/s
  gust_magnitude: 2.0              # max gust strength (m/s)
  gust_frequency: 0.1              # how often gusts change (Hz)

# Formation Settings
formation:
  spacing: 3.0  # meters
  patterns:
    - "line"
    - "circle"
    - "grid"
    - "v_formation"